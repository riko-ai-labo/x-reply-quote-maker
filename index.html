<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="theme-color" content="#121212" media="(prefers-color-scheme: dark)">
  <meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Xリプ&引用ポストつくるちゃん">
  <title>Xリプ&引用ポストつくるちゃん</title>
  <link rel="manifest" href="manifest.json">
  <link rel="apple-touch-icon" href="icon-192.png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600&family=Zen+Kaku+Gothic+New:wght@400;500;700&display=swap"
    rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>

<body>
  <div class="container">
    <header>
      <h1>Xリプ&引用ポストつくるちゃん</h1>
      <button id="settings-toggle" class="icon-btn" aria-label="設定">
        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none"
          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path
            d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.09a2 2 0 0 1-1-1.74v-.47a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z">
          </path>
          <circle cx="12" cy="12" r="3"></circle>
        </svg>
      </button>
    </header>

    <div id="settings-panel" class="panel hidden">
      <div class="panel-header">
        <h2>設定</h2>
        <button id="close-settings" class="icon-btn">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
        </button>
      </div>
      <div class="settings-scroll">
        <div class="form-group">
          <label for="api-key">Gemini API Key</label>
          <div class="input-wrapper">
            <input type="password" id="api-key" placeholder="APIキーを入力してください" spellcheck="false"
              autocomplete="off">
            <button id="toggle-api-visibility" class="icon-btn-small">👁️</button>
          </div>
          <small><a href="https://aistudio.google.com/app/apikey" target="_blank" rel="noopener">APIキーを取得する</a></small>
        </div>
        <div class="form-group">
          <label for="gemini-model">Gemini モデル</label>
          <select id="gemini-model">
            <option value="gemini-3-pro-preview">Gemini 3 Pro（最高性能）</option>
            <option value="gemini-3-flash-preview">Gemini 3 Flash（高性能・高速）</option>
            <option value="gemini-2.5-flash" selected>Gemini 2.5 Flash（高速・推奨）</option>
            <option value="gemini-2.5-flash-lite">Gemini 2.5 Flash Lite（最速・軽量）</option>
            <option value="gemini-2.5-pro">Gemini 2.5 Pro（高品質）</option>
          </select>
        </div>
        <div class="form-group">
          <label for="system-prompt">文体・トーン (プロンプト)</label>
          <textarea id="system-prompt" rows="6"
            placeholder="例：あなたは関西弁を話す陽気なAIです。絵文字を多用して、親しみやすく返信してください。相手の投稿に共感を示しつつ、ユーモアを交えてください。"></textarea>
        </div>
        <button id="save-settings" class="btn primary full-width">保存する</button>
      </div>
    </div>

    <main id="main-content">
      <div class="card target-post-card">
        <label for="target-text" class="card-label">ポストの内容</label>
        <textarea id="target-text" rows="4"
          placeholder="リプライしたいポストの内容をここに貼り付けてください" spellcheck="false"></textarea>
        <div class="textarea-actions">
          <button id="paste-btn" class="btn secondary small" title="クリップボードから貼り付け">
            <span class="icon">📋</span> 貼り付け
          </button>
          <button id="clear-btn" class="btn secondary small" title="入力内容をクリア">
            <span class="icon">🗑️</span> クリア
          </button>
        </div>
      </div>

      <div class="actions">
        <button id="generate-btn" class="btn primary" disabled>
          <span class="text">リプライ生成 ✨</span>
          <div class="loader hidden"></div>
        </button>
        <button id="generate-quote-btn" class="btn quote" disabled>
          <span class="text">引用ポスト生成 🔁</span>
          <div class="loader hidden"></div>
        </button>
      </div>
      <div class="actions">
        <button id="cancel-btn" class="btn cancel full-width hidden">キャンセル</button>
      </div>

      <div id="result-area" class="hidden">
        <h3 id="result-heading">生成されたリプライ案</h3>

        <div class="reply-card card">
          <div class="card-header-small">
            <span class="badge">パターンA</span>
            <button class="icon-btn copy-btn" data-target="reply-1" title="コピー">
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
              </svg>
            </button>
          </div>
          <div id="reply-1" class="generated-content" contenteditable="true"></div>
        </div>

        <div class="reply-card card">
          <div class="card-header-small">
            <span class="badge">パターンB</span>
            <button class="icon-btn copy-btn" data-target="reply-2" title="コピー">
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
              </svg>
            </button>
          </div>
          <div id="reply-2" class="generated-content" contenteditable="true"></div>
        </div>

        <div class="reply-card card">
          <div class="card-header-small">
            <span class="badge">パターンC</span>
            <button class="icon-btn copy-btn" data-target="reply-3" title="コピー">
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
              </svg>
            </button>
          </div>
          <div id="reply-3" class="generated-content" contenteditable="true"></div>
        </div>
      </div>

      <div id="error-message" class="error-toast hidden"></div>
      <div id="success-message" class="success-toast hidden"></div>
    </main>

    <div id="install-overlay" class="install-overlay hidden">
      <div class="install-dialog">
        <div class="install-icon">
          <img src="icon-192.png" alt="アプリアイコン" width="64" height="64">
        </div>
        <h2 class="install-title">ホーム画面に追加しますか？</h2>
        <p class="install-desc">ホーム画面からすぐにアクセスできるようになります</p>
        <div class="install-actions">
          <button id="install-cancel" class="btn secondary">あとで</button>
          <button id="install-ok" class="btn primary">追加する</button>
        </div>
      </div>
    </div>

    <footer>
      <p>Powered by <span id="footer-model">Gemini 2.5 Flash</span></p>
    </footer>
  </div>
  <script src="app.js"></script>
</body>

</html>
